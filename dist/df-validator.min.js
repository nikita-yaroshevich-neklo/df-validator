!function(e){e.module("df.validator.config",[]).value("df.validator.config",{debug:!0}),e.module("df.validator.services",[]),e.module("df.validator",["df.validator.config","df.validator.services"])}(angular),angular.module("df.validator").service("defaultValidationRules",function(e,t,r,a,n){function i(t,r,a){var n=a.message?a.message:this.message;throw n=e(n)(angular.extend({value:t,object:r},a))}return{required:{message:"This field is required",validate:function(e,t,r){return r=r||{},e&&0!==e.length?!0:i.apply(this,[e,t,r])}},minlength:{message:"Must be at least {{rule}} characters",validate:function(e,t,r){return r=angular.isObject(r)?r:{rule:r},!e||e.length<r.rule?i.apply(this,[e,t,r]):!0}},maxlength:{message:"Must be fewer than {{rule}} characters",validate:function(e,t,r){return r=angular.isObject(r)?r:{rule:r},e&&e.length>r.rule?i.apply(this,[e,t,r]):!0}},equal:{message:"Must be equal",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var a=angular.isObject(r.rule)&&r.rule.field?n(r.rule.field)(t):r.rule,l=r.rule.byValue||!1;return l&&e!==a?i.apply(this,[e,t,r]):l||e==a?!0:i.apply(this,[e,t,r])}},notEqual:{message:"Must be equal",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var a=angular.isObject(r.rule)&&r.rule.field?n(r.rule.field)(t):r.rule,l=r.rule.byValue||!1;return l&&e===a?i.apply(this,[e,t,r]):l||e!=a?!0:i.apply(this,[e,t,r])}},type:{message:"Must be an {{rule}}",validate:function(e,t,r){if(r=angular.isObject(r)?r:{rule:r},!e)return!0;var a=e.toString();return"integer"===r.rule&&a&&!a.match(/^\-*[0-9]+$/)?i.apply(this,[e,t,r]):"number"===r.rule&&a&&!a.match(/^\-*[0-9\.]+$/)?i.apply(this,[e,t,r]):"negative"===r.rule&&a&&!a.match(/^\-[0-9\.]+$/)?i.apply(this,[e,t,r]):"positive"===r.rule&&a&&!a.match(/^[0-9\.]+$/)?i.apply(this,[e,t,r]):"email"===r.rule&&a&&!a.match(/^.+@.+$/)?i.apply(this,[e,t,r]):"phone"===r.rule&&a&&!a.match(/^\+?[0-9\-]+\*?$/)?i.apply(this,[e,t,r]):!0}},pattern:{message:"Invalid format",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var a=r.rule instanceof RegExp?r.rule:new RegExp(r.rule);return e&&!a.exec(e)?i.apply(this,[e,t,r]):!0}},custom:{message:"Invalid value",validate:function(e,t,r){return r.rule(e,t,r)}},lessThan:{message:"This field should be less than {{errorField}}",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r},r.rule=angular.isString(r.rule)?r.rule.split(/[ ,;]+/).filter(Boolean):[r.rule];var n=parseFloat(e),l=!0;isNaN(n)?l=!1:e=n;for(var u=0;u<r.rule.length;u++){var o=null,s=t[r.rule[u]]||r.rule[u];if(s){if(l){if(isNaN(parseFloat(s)))continue;o=s=parseFloat(s)}if(e>s)return o=null===o?a("humanize")(a("tableize")(r.rule[u])):o,i.apply(this,[e,t,angular.extend(r,{errorField:o})])}}return!0}},dateDiff:{message:"Invalid Date diff",validate:function(e,t,a){if(a.rule){var n=r(e),l=r(a.rule.field?t[a.rule.field].$modelValue||t[a.rule.field]:a.rule.date);if(a.rule.range=a.rule.range||0,a.rule.term=a.rule.term||"days",a.rule.more){if(n.diff(l,a.rule.term)<a.rule.range)return i.apply(this,[e,t,a])}else if(n.diff(l,a.rule.term)>a.rule.range)return i.apply(this,[e,t,a]);return!0}}}}}),function(){"use strict";angular.module("df.validator").service("dfValidationUtils",function(){function e(){}return e.prototype={flattenObjectKeys:function(e){for(var t=[],r=[{object:e,prefix:null}];;){if(0===r.length)break;var a=r.pop(),n=a.prefix?a.prefix+".":"";if("object"==typeof a.object)for(var i in a.object){var l=n+i;t.push(l),r.push({object:a.object[i],prefix:l})}}return t}},new e})}(),angular.module("df.validator").service("formValidator",function(e,t,r,a){function n(){}return n.prototype={$getRulesForFieldName:function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),r(t)(e)},validateAll:function(){throw"Not Implemented"},validateField:function(t,r,n,i,l){l=angular.copy(l);var u=this.$getRulesForFieldName(l,i),o=r||t;if(angular.isString(o)&&(o=o.replace(/\s+$/,"")),!u)return e.resolve();var s=e.defer();return function c(t){function r(t){var r;if(a.has(t.name)){var i=a.get(t.name);try{r=i.validate(o,n,t)}catch(l){return e.reject(l.message||l||i.message)}return angular.isObject(r)&&angular.isFunction(r.then)?r.then(function(t){return e.when(t)},function(t){return e.reject(t||i.message)}):r?e.when(r):e.reject(i.message)}return e.reject("Unknown validation rule with name "+t.name)}var i=t.shift();return r(i).then(function(){return 0===t.length?s.resolve():c(t)}).catch(s.reject)}(u),s.promise}},new n}),angular.module("df.validator").service("objectValidator",function(e,t,r,a){function n(){}return n.prototype={$getRulesForFieldName:function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),r(t)(e)},validateAll:function(e,r){var a=t.flattenObjectKeys(r);return this.validateFields(e,a,r)},validateFields:function(t,a,n){n=angular.copy(n);var i=e.defer(),l=[],u={};return angular.forEach(a,function(e){var a=this.$getRulesForFieldName(n,e);if(a){var i;i=this.validateField(t,e,n),i.then(angular.noop,function(t){r(e).assign(u,t)}),l.push(i)}},this),e.all(l).then(i.resolve,function(){i.reject(u)}),i.promise},validateField:function(t,n,i){var l=this.$getRulesForFieldName(i,n),u=r(n)(t);angular.isString(u)&&(u=u.replace(/\s+$/,""));var o=e.defer();return function s(r){function n(r){var n;if(a.has(r.name)){var i=a.get(r.name),l=r;try{n=i.validate(u,t,l)}catch(o){return e.reject(o||i.message)}return angular.isObject(n)&&angular.isFunction(n.then)?n.then(function(t){return e.when(t)},function(t){return e.reject(t||i.message)}):n?e.when(n):e.reject(i.message)}return e.reject("Unknown validation rule with name "+ruleName)}r.shift();return n(r).then(function(){return 0===r.length?o.resolve():s(r)}).catch(o.reject)}(l),o.promise},isCollectionRequired:function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.collection&&r.collection.min&&(angular.isObject(r.collection.min)?r.collection.min.rule:r.collection.min)},isFieldRequired:function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.required&&(angular.isObject(r.required)?r.required.rule:r.required)}},new n}),angular.module("df.validator").provider("validator",function(){var e={};this.add=function(t,r){return e[t]=r,this},this.addCollection=function(e){var t=this;angular.forEach(e,function(e,r){t.add(r,e.validators||e)})},this.remove=function(t){return delete e[t],this},this.has=function(t){return void 0!==e[t]},this.get=function(t){return e[t]||{}};var t=this;this.$get=function(e,r,a,n){function i(){}return i.prototype={add:function(e,r){return t.add(e,r),this},remove:function(e){return t.remove(e),this},has:function(e){return t.has(e)},get:function(e){return t.get(e)},addRule:function(e,t){return n.add(e,t),this},removeRule:function(e){return n.remove(e),this},hasRule:function(e){return n.has(e)},getRule:function(e){return n.get(e)},getValidationRules:function(e){return e=angular.isFunction(e)?this.get(e.constructor.name):e,e=angular.isString(e)?this.get(e):e},validate:function(e,t){return t=angular.isObject(t)?t:this.getValidationRules(t||e),r.validateAll(e,t)},validateField:function(e,t,a){var n=angular.isString(t)?[t]:t;return r.validateFields(e,n,this.getValidationRules(a||e))},validateFormField:function(e,t,r,n,i){return a.validateField(e,t,r,n,i)}},new i}}),angular.module("df.validator").service("validatorRulesCollection",function(e,t){var r={};this.add=function(e,t){if(angular.isFunction(t)&&(t={message:"Invalid value",validate:t}),!angular.isFunction(t.validate))throw"Invalid validator object type";return r[e]=t,this},this.remove=function(e){return delete r[e],this},this.has=function(e){return r[e]},this.get=function(e){return r[e]};var a=this;angular.forEach(t,function(e,t){a.add(t,e)})});